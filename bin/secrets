#!/usr/bin/env sh

set -e
. "./bin/functions"

env=${1:-"dev"}

if [ -z "$(ls -A .secrets)" ]; then
  pp_info "setup" "Initialising submodule..."
  git submodule update --init --recursive
fi

pp_info "setup" "Setting up env..."
git submodule update --recursive --remote

if [ -f .envrc ]; then
  printf "envrc file updated.\n"
else
  ln -s .secrets/$env .envrc
  printf "envrc file created.\n"
fi
